(this["webpackJsonpexcel-parser"]=this["webpackJsonpexcel-parser"]||[]).push([[5],{289:function(e,a){},291:function(e,a){},343:function(e,a,t){"use strict";t.r(a);var n=t(87),r=t.n(n),c=t(88),l=t(62),u=t(0),o=t.n(u),i=t(352),s=t(156),m=t.n(s),b=t(63),p=t(117),g=t.n(p);a.default=function(){var e=Object(u.useState)([]),a=Object(l.a)(e,2),t=a[0],n=a[1],s=Object(u.useState)([]),p=Object(l.a)(s,2),f=p[0],h=p[1],O=Object(u.useState)(!1),E=Object(l.a)(O,2),d=E[0],j=E[1],v=Object(u.useState)([]),x=Object(l.a)(v,2),S=x[0],D=x[1],C=Object(u.useState)({}),k=Object(l.a)(C,2),y=k[0],w=k[1],N=Object(u.useState)({}),T=Object(l.a)(N,2),A=T[0],R=T[1],I=function(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var t={labels:e,datasets:[{label:"Net Profit analysis",backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(255, 99, 132, 0.6)"],hoverBackgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(255, 99, 132, 0.6)"],borderWidth:2,data:a}]};return t};Object(u.useEffect)((function(){console.table(S),P()}),[S]);var P=function(){var e=Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(S&&S.length>0)){e.next=4;break}return e.next=3,g.a.post("http://localhost:3001/save-excel",S);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(c.a)(r.a.mark((function e(a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Object(i.a)(a.target.files[0]).then((function(e){if(e&&e.length>0){for(var a=[],t=[],r=[],c=[],l=[],u={},o={},i=0;i<e.length;i++){var s={},m=e[i];i>3&&(s.date=m[0],s.name=m[1],s.voucherType=m[2],s.state=m[3],s.total=m[4],s.salesman=m[5],l.push(s),a.push(m[3]),t.push(m[3]),r.push(m[4]),c.push(m[4])),i>2&&i<6&&(u[e[i][6]]=e[i][7]),i>6&&i<10&&(o[e[i][6]]=e[i][7])}w(u),R(o),console.log("@@@_puchase",o),D(l);var b=I(a,r,e[1][0]),p=I(t,r,e[1][0]);j(!0),n(b),h(p)}})),Object(i.a)(a.target.files[0],{sheet:"Sheet1"}).then((function(e){return e}))}catch(t){console.log("@@@@error",t)}case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return m()(".image-upload-wrap").bind("dragover",(function(){m()(".image-upload-wrap").addClass("image-dropping")})),m()(".image-upload-wrap").bind("dragleave",(function(){m()(".image-upload-wrap").removeClass("image-dropping")})),o.a.createElement(o.a.Fragment,null,d?o.a.createElement(b.a,{barGraphOneData:t,barGraphTwoData:f,excelData:S,salesData:y,puchase:A,goToHome:function(){j(!1)}}):o.a.createElement("div",{className:"file-upload"},o.a.createElement("button",{className:"file-upload-btn",type:"button",onClick:function(e){m()(".file-upload-input").trigger("click")}},"Add Image"),o.a.createElement("div",{className:"image-upload-wrap"},o.a.createElement("input",{className:"file-upload-input",type:"file",onChange:function(e){W(e)}}),o.a.createElement("div",{className:"drag-text"},o.a.createElement("h3",null,"Drag and drop a file or select add Image"))),o.a.createElement("div",{className:"file-upload-content"},o.a.createElement("img",{className:"file-upload-image",src:"#",alt:"your image"}),o.a.createElement("div",{className:"image-title-wrap"},o.a.createElement("button",{type:"button",onClick:(m()(".file-upload-input").replaceWith(m()(".file-upload-input").clone()),m()(".file-upload-content").hide(),void m()(".image-upload-wrap").show()),className:"remove-image"},"Remove ",o.a.createElement("span",{className:"image-title"},"Uploaded Image"))))))}},63:function(e,a,t){"use strict";var n=t(62),r=t(0),c=t.n(r),l=t(89),u=t(344),o=t(345),i=t(346),s=t(347),m=t(354),b=t(353),p=t(348),g=t(349),f=t(350);a.a=function(e){var a=Object(r.useState)(""),t=Object(n.a)(a,2),h=(t[0],t[1],Object(r.useState)("state")),O=Object(n.a)(h,2),E=O[0],d=O[1],j=Object(r.useState)("voucherType"),v=Object(n.a)(j,2),x=v[0],S=v[1],D=Object(r.useState)("name"),C=Object(n.a)(D,2),k=C[0],y=C[1],w=Object(r.useState)("salesman"),N=Object(n.a)(w,2),T=N[0],A=N[1],R=Object(r.useState)([]),I=Object(n.a)(R,2),P=I[0],W=I[1],B=Object(r.useState)([]),F=Object(n.a)(B,2),G=F[0],J=F[1],H=Object(r.useState)([]),U=Object(n.a)(H,2),_=U[0],q=U[1],z=Object(r.useState)([]),K=Object(n.a)(z,2),L=K[0],M=K[1],Q=Object(r.useState)([]),V=Object(n.a)(Q,2),X=V[0],Y=V[1],Z=Object(r.useState)([]),$=Object(n.a)(Z,2),ee=$[0],ae=$[1],te=Object(r.useState)([]),ne=Object(n.a)(te,2),re=ne[0],ce=ne[1],le=Object(r.useState)(["name","voucherType","state","salesman"]),ue=Object(n.a)(le,2),oe=ue[0],ie=(ue[1],Object(r.useState)(!1)),se=Object(n.a)(ie,2),me=se[0],be=se[1],pe=Object(r.useState)(!1),ge=Object(n.a)(pe,2),fe=ge[0],he=ge[1],Oe=Object(r.useState)(!1),Ee=Object(n.a)(Oe,2),de=Ee[0],je=Ee[1],ve=Object(r.useState)(!1),xe=Object(n.a)(ve,2),Se=xe[0],De=xe[1],Ce=function(e){d(e.currentTarget.textContent)},ke=function(e){S(e.currentTarget.textContent)},ye=function(e){y(e.currentTarget.textContent)},we=function(e){A(e.currentTarget.textContent)},Ne=function(e,a){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var t={labels:e,datasets:[{label:"Net Profit analysis",backgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(255, 99, 132, 0.6)"],hoverBackgroundColor:["rgba(255, 99, 132, 0.6)","rgba(54, 162, 235, 0.6)","rgba(255, 206, 86, 0.6)","rgba(75, 192, 192, 0.6)","rgba(153, 102, 255, 0.6)","rgba(255, 159, 64, 0.6)","rgba(255, 99, 132, 0.6)"],borderWidth:2,data:a}]};return t};return Object(r.useEffect)((function(){if(e.salesData){var a=Ne(Object.keys(e.salesData),Object.values(e.salesData),"Sales Data");Y(a)}if(e.puchase){var t=Ne(Object.keys(e.puchase),Object.values(e.puchase),"Puchase Data");ae(t)}var n=[e.salesData.Total,e.puchase.Total],r=Ne(["sales","purchase"],n);ce(r)}),[]),Object(r.useEffect)((function(){var a=[],t=[];if(e&&e.excelData){for(var n=0;n<e.excelData.length;n++){var r=e.excelData[n],c=a.indexOf(r[E]||"Other");-1!==c?t[c]+=r.total:(a.push(r[E]||"Other"),t.push(r.total))}var l=Ne(a,t,E);W(l)}}),[E]),Object(r.useEffect)((function(){var a=[],t=[];if(e&&e.excelData){for(var n=0;n<e.excelData.length;n++){var r=e.excelData[n],c=a.indexOf(r[x]||"Other");-1!==c?t[c]+=r.total:(a.push(r[x]||"Other"),t.push(r.total))}var l=Ne(a,t,x);J(l)}}),[x]),Object(r.useEffect)((function(){var a=[],t=[];if(e&&e.excelData){for(var n=0;n<e.excelData.length;n++){var r=e.excelData[n],c=a.indexOf(r[k]||"Other");-1!==c?t[c]+=r.total:(a.push(r[k]||"Other"),t.push(r.total))}var l=Ne(a,t,k);q(l)}}),[k]),Object(r.useEffect)((function(){var a=[],t=[];if(e&&e.excelData){for(var n=0;n<e.excelData.length;n++){var r=e.excelData[n],c=a.indexOf(r[T]||"Other");-1!==c?t[c]+=r.total:(a.push(r[T]||"Other"),t.push(r.total))}var l=Ne(a,t,T);M(l)}}),[T]),c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,null,c.a.createElement(o.a,null,c.a.createElement(i.a,null,c.a.createElement(s.a,{isOpen:me,toggle:function(){return be((function(e){return!e}))}},c.a.createElement(m.a,{caret:!0},E||"Select Category"),c.a.createElement(b.a,{right:!0},oe&&oe.map((function(e){return c.a.createElement(p.a,{onClick:Ce},e)})))),c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:P,options:{maintainAspectRatio:!1},height:200})))),c.a.createElement(i.a,null,c.a.createElement(s.a,{isOpen:fe,toggle:function(){return he((function(e){return!e}))}},c.a.createElement(m.a,{caret:!0},x||"Select Category"),c.a.createElement(b.a,{right:!0},oe&&oe.map((function(e){return c.a.createElement(p.a,{onClick:ke},e)})))),c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:G,options:{maintainAspectRatio:!1},height:200}))))),c.a.createElement(o.a,null,c.a.createElement(i.a,null,c.a.createElement(s.a,{isOpen:de,toggle:function(){return je((function(e){return!e}))}},c.a.createElement(m.a,{caret:!0},k||"Select Category"),c.a.createElement(b.a,{right:!0},oe&&oe.map((function(e){return c.a.createElement(p.a,{onClick:ye},e)})))),c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:_,options:{maintainAspectRatio:!1},height:200})))),c.a.createElement(i.a,null,c.a.createElement(s.a,{isOpen:Se,toggle:function(){return De((function(e){return!e}))}},c.a.createElement(m.a,{caret:!0},T||"Select Category"),c.a.createElement(b.a,{right:!0},oe&&oe.map((function(e){return c.a.createElement(p.a,{onClick:we},e)})))),c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:L,options:{maintainAspectRatio:!1},height:200}))))),c.a.createElement(o.a,null,c.a.createElement("br",null)),c.a.createElement(o.a,null,c.a.createElement(i.a,null,c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:X,options:{maintainAspectRatio:!1},height:200})))),c.a.createElement(i.a,null,c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:ee,options:{maintainAspectRatio:!1},height:200}))))),c.a.createElement(o.a,null,c.a.createElement(i.a,null,c.a.createElement(g.a,null,c.a.createElement(f.a,null,c.a.createElement(l.a,{data:re,options:{maintainAspectRatio:!1},height:200})))))))}}}]);
//# sourceMappingURL=5.1bf29af0.chunk.js.map